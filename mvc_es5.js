'use strict';var _get=function a(b,c,d){null===b&&(b=Function.prototype);var f=Object.getOwnPropertyDescriptor(b,c);if(f===void 0){var g=Object.getPrototypeOf(b);return null===g?void 0:a(g,c,d)}if('value'in f)return f.value;var h=f.get;return void 0===h?void 0:h.call(d)},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var MC=function(){function a(){_classCallCheck(this,a),this.model=null,this.url=null}return _createClass(a,[{key:'httpDelete',value:function httpDelete(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model={id:this.model.id,__Status:'DEL'},this.httpPatch(b,c)}},{key:'httpGet',value:function httpGet(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};$.ajax(this.url+'(\''+b+'\')',{error:function error(f,g,h){d(f,g,h)},method:'GET',success:function success(f,g,h){c(f,g,h)}})}},{key:'httpPatch',value:function httpPatch(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};$.ajax(this.url+'(\''+this.model.id+'\')',{data:JSON.stringify(this.model),error:function error(d,f,g){c(d,f,g)},method:'PATCH',success:function success(d,f,g){b(d,f,g)}})}},{key:'httpPost',value:function httpPost(){var d=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model.id=null,$.ajax(this.url,{data:JSON.stringify(this.model),error:function error(f,g,h){c(f,g,h)},method:'POST',success:function success(f,g,h){d._model.id=h.getResponseHeader('OData-EntityID'),b(f,g,h)}})}},{key:'httpPut',value:function httpPut(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};$.ajax(this.url+'(\''+this.model.id+'\')',{data:JSON.stringify(this.model),error:function error(d,f,g){c(d,f,g)},method:'PUT',success:function success(d,f,g){b(d,f,g)}})}}]),a}(),CotModelMC=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.cotModel=null,c}return _inherits(b,a),_createClass(b,[{key:'httpDelete',value:function httpDelete(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model=this.cotModel.toJSON(),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'httpDelete',this).call(this,c,d)}},{key:'httpGet',value:function httpGet(c){var g=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'httpGet',this).call(this,c,function(h,j,k){g._cotModel.set(g.model),d(h,j,k)},f)}},{key:'httpPatch',value:function httpPatch(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model=this.cotModel.toJSON(),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'httpPatch',this).call(this,c,d)}},{key:'httpPost',value:function httpPost(){var f=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model=this.cotModel.toJSON(),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'httpPost',this).call(this,function(g,h,j){f.cotModel.set('id',f.model.id),c(g,h,j)},d)}},{key:'httpPut',value:function httpPut(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};this.model=this.cotModel.toJSON(),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'httpPut',this).call(this,c,d)}}]),b}(MC),VC=function(){function a(){_classCallCheck(this,a),this.renderedOnce=null}return _createClass(a,[{key:'remove',value:function remove(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};b()}},{key:'render',value:function render(){var f=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},d=function(){f.render_always(b,c)};!0==this.renderedOnce?d():(this.renderedOnce=!0,this.render_once(d,c))}},{key:'render_always',value:function render_always(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};b()}},{key:'render_once',value:function render_once(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};b()}}]),a}(),NavVC=function(a){function b(){_classCallCheck(this,b),console.log('* NAV VC - CONSTRUCTOR');var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.vcs=null,c}return _inherits(b,a),_createClass(b,[{key:'closeVC',value:function closeVC(c){var h=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};if(console.log('* NAV VC - CLOSE VC'),null!=this.vcs&&0<this.vcs.length&&this.vcs[this.vcs.length-1]==c)if(this.vcs.pop(),0<this.vcs.length){var g=this.vcs.pop();this.vcs.push(c,g)}else c.$view.hide();this.render(function(){var j=h.vcs.indexOf(c);-1!=j&&h.vcs.splice(j,1),c.remove(d,f)},f)}},{key:'openVC',value:function openVC(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};console.log('* NAV VC - OPEN VC'),null==this.vcs&&(this.vcs=[]);var g=this.vcs.indexOf(c);-1!=g&&this.vcs.splice(g,1),this.vcs.push(c),this.render(d,f)}},{key:'render_always',value:function render_always(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAV VC - RENDER ALWAYS'),this.render_always_vc(c,d)}},{key:'render_always_vc',value:function render_always_vc(){var g=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAV VC - RENDER ALWAYS VC');var f=function(){var h=g.vcs[g.vcs.length-1];h.navVC=g,h.render(function(){h.$view.fadeIn(c)},d)};null==this.vcs||0==this.vcs.length?c():1<this.vcs.length?this.vcs[this.vcs.length-2].$view.fadeOut(f):f()}}]),b}(VC),NavbarVC=function(a){function b(){_classCallCheck(this,b),console.log('* NAVBAR VC - CONSTRUCTOR');var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.$view=null,c.cotApp=null,c.cotLogin=null,c.defaultVC=null,c.menu=null,c.vcClasses=null,c}return _inherits(b,a),_createClass(b,[{key:'closeVC',value:function closeVC(c){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};console.log('* NAVBAR VC - CLOSE VC');var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var h,j,g=this.menu[Symbol.iterator]();!(_iteratorNormalCompletion=(h=g.next()).done);_iteratorNormalCompletion=!0)j=h.value,console.log('CHECK MENU VC',j.vc,c),j.vc===c&&(j.vc=null)}catch(k){_didIteratorError=!0,_iteratorError=k}finally{try{!_iteratorNormalCompletion&&g.return&&g.return()}finally{if(_didIteratorError)throw _iteratorError}}console.log('CHECK DEFAULT VC',this.defaultVC.vc,c),this.defaultVC.vc==c&&(this.defaultVC.vc=null),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'closeVC',this).call(this,c,d,f)}},{key:'render_always',value:function render_always(){var f=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAVBAR VC - RENDER ALWAYS'),this.$view.filter('.requireLogin').hide(),this.render_always_login(function(){f.render_always_vc(function(){f.render_always_menu(c,d)},d)},d)}},{key:'render_always_login',value:function render_always_login(){var g=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAVBAR VC - RENDER ALWAYS LOGIN');var f=this.$view.find('.navbar-login').empty();null==this.cotLogin||(this.cotLogin.isLoggedIn()?f.append('\n\t\t\t\t\t\t<form class="navbar-form navbar-left">\n\t\t\t\t\t\t\t<p class="form-control-static">'+this.cotLogin.username+'</p>\n\t\t\t\t\t\t\t<button class="btn btn-default btn-logout" type="button">Logout</button>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t').find('.btn-logout').on('click',function(h){h.preventDefault(),g.cotLogin.logout()}):f.append('\n\t\t\t\t\t\t<form class="navbar-form navbar-left">\n\t\t\t\t\t\t\t<button class="btn btn-default btn-login" type="button">Login</button>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t').find('.btn-login').on('click',function(h){h.preventDefault(),g.cotLogin.showLogin()})),c()}},{key:'render_always_menu',value:function render_always_menu(){var k=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAVBAR VC - RENDER ALWAYS MENU');var f=this.$view.find('.navbar-menu');f.html('\n\t\t\t<ul class="nav navbar-nav">\n\t\t\t\t<li class="dropdown">\n\t\t\t\t\t<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Navigation <span class="caret"></span></a>\n\t\t\t\t\t<ul class="dropdown-menu">\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t');var g=f.find('ul.dropdown-menu');if(null!=this.menu){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var j,_loop=function(){var o=j.value,p=$('<li><a href="#">'+o.title+'</a></li>');g.append(p),p.find('a').on('click',function(q){q.preventDefault(),console.log('MENU CLICK'),console.log('MENU VC',o.vc),null==o.vc&&(o.vc=new k.vcClasses[o.vcClass],o.vc.options=o.vcOptions),k.openVC(o.vc)})},h=this.menu[Symbol.iterator]();!(_iteratorNormalCompletion2=(j=h.next()).done);_iteratorNormalCompletion2=!0)_loop()}catch(o){_didIteratorError2=!0,_iteratorError2=o}finally{try{!_iteratorNormalCompletion2&&h.return&&h.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}var l=this.vcs.filter(function(o){return null!=o.title});if(null!=this.menu&0<this.menu.length&&null!=l&&0<l.length&&g.append($('<li role="separator" class="divider"></li>')),null!=l){var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var n,_loop2=function(){var o=n.value,p=$('<li><a href="#">'+(o.title||'Untitled')+'</a></li>');g.append(p),p.find('a').on('click',function(q){q.preventDefault(),k.openVC(o)})},m=l[Symbol.iterator]();!(_iteratorNormalCompletion3=(n=m.next()).done);_iteratorNormalCompletion3=!0)_loop2()}catch(o){_didIteratorError3=!0,_iteratorError3=o}finally{try{!_iteratorNormalCompletion3&&m.return&&m.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}c()}},{key:'render_always_vc',value:function render_always_vc(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAVBAR VC - RENDER ALWAYS VC'),null==this.vcs||0==this.vcs.length?(console.log('RENDER ALWAYS VC NULL'),null==this.defaultVC.vc&&(this.defaultVC.vc=new this.vcClasses[this.defaultVC.vcClass],this.defaultVC.vc.options=this.defaultVC.vcOptions),this.openVC(this.defaultVC.vc,c,d)):(console.log('RENDER ALWAYS VC NOT NULL'),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'render_always_vc',this).call(this,c,d))}},{key:'render_once',value:function render_once(){var f=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};console.log('* NAVBAR VC - RENDER ONCE'),null!=this.cotLogin&&(this.cotLogin.options.onLogin=function(){f.render()}),this.$view=$('\n\t\t\t<nav class="navbar navbar-default navvc">\n\t\t\t\t<div class="container-fluid">\n\t\t\t\t\t<div class="navbar-header">\n\t\t\t\t\t\t<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">\n\t\t\t\t\t\t\t<span class="sr-only">Toggle navigation</span>\n\t\t\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<span class="navbar-brand"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n\t\t\t\t\t\t<div class="navbar-left">\n\t\t\t\t\t\t\t<div class="navbar-vc-ui"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="navbar-right">\n\t\t\t\t\t\t\t<div class="navbar-menu"></div>\n\t\t\t\t\t\t\t<div class="navbar-login"></div>\n\t\t\t\t\t\t\t<div class="navbar-lock"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t\t<div class="requireLogin">\n\t\t\t\t<p>Please login.</p>\n\t\t\t</div>\n\t\t'),$('.navbar-lock',this.$view.filter('.navbar')).append($('.securesite > img')),$('#app-content-top > div').append(this.$view),c()}}]),b}(NavVC);
